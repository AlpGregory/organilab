{% extends 'base.html' %}
{% load static i18n gtsettings %}
{% block pre_head %}
    {% define_true  "use_datatables" %}
{% endblock %}

{% block content %}
<div class="row">
<div class="col-md-offset-2 col-md-8">
        <div class="page-header col-xs-13" align="center">
          <h3 class="heading-1" ><span> {% trans 'List of Substances' %}  </span></h3>
        </div>
</div>
</div>

<div class="row">
<div class="col-md-12">
    <div class="add-container pull-right">
        <a class="btn btn-success" href="{% url 'create_sustance' organilabcontext %}"><i class="glyphicon glyphicon-plus white"
                                                        title="{% trans 'Add new Substance' %}"></i> {% trans 'Add' %}</a>
    </div>
    <br>
  <table id="sustancetable" class="table table-striped table-bordered" style="width:100%">
        <thead>
            <tr>
                <th>{% trans 'Name' %}</th>
                <th>{% trans 'Cas code' %}</th>
                <th>{% trans 'Status' %}</th>
                <th>{% trans 'Actions' %}</th>
            </tr>
        </thead>
        <tbody>
            {% for substance in substances %}
                <tr>
                    <td>{{substance.comercial_name}}</td>
                    <td>{{substance.substancecharacteristics.cas_id_number}}</td>
                    <td><p class="text-center"> No</p></td>
                    <td><a href="{% url 'update_substance' organilabcontext substance.pk  %}" class="btn btn-warning"><i class="icons fa fa-edit"></i></a>
                        <a data-target="#delete_modal" data-toggle="modal" data-substance="{{substance.pk}}" class="btn btn-danger remove"><i class="icons fa fa-trash"></i></a>
                        <a class="btn btn-info" href="{% url 'detail_substance' organilabcontext substance.pk %}"><i class="icons fa fa-eye"></i></a>
                    </td>
                </tr>
            {% endfor %}
        </tbody>
  </table>
</div>
</div>


<div aria-hidden="true"  class="modal fade" id="delete_modal" role="dialog"
     tabindex="-1">
    <div class="modal-dialog" role="document">
        <div class="modal-content modal-sm">
            <div class="modal-header">
                <h5 class="modal-title pull-left" id="model_reservation_form_title">{% trans 'Delete Substance' %}</h5>
                <button aria-label="{% trans 'Close' %}" class="close pull-right" data-dismiss="modal" type="button">
                    <span aria-hidden="true">&times;</span>
                </button>
            </div>
            <div class="modal-body">
                <label>{% trans 'Â¿You want to remove the substance?' %}</label>
            </div>
            <div class="modal-footer">
                <button class="btn btn-danger" data-dismiss="modal" type="button">{% trans 'Close' %}</button>
                <a class="btn btn-success" id="remove_substance">{% trans 'Delete' %}</a>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block js %}
{{block.super}}

<script>

(function(){
    $("#sustancetable").DataTable();
    $(".remove").click((e)=>{
        var id = e.target.dataset['substance']
        var url = "{% url 'delete_substance' organilabcontext 0 %}";
        if(id){
            url = url.replace('0', id);
        }

        document.querySelector("#remove_substance").setAttribute('href',url)

    })
})(jQuery);
</script>



{% endblock %}