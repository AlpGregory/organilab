{% extends 'base.html' %}
{% load bootstrap i18n static laboratory gtsettings %}
{% block pre_head %}
    {% define_true  "use_datatables" %}
{% endblock %}
{% block title %}{% trans 'Access List' %}{% endblock %}
{% block content %}
  <div class="row">
    <div class="col-md-offset-2 col-md-8">
      <div align="center">
        <h3 class="heading-1" ><span> {% trans 'Access List' %}</span></h3>
        <div class="x_panel">
          <div class="x_title">
            <h2>{% trans 'Laboratories List' %}</h2>
            <ul class="nav navbar-right panel_toolbox"></ul>
            <div class="clearfix"></div>
          </div>
          <div class="x_content">
            <table id="labs" class="table table-striped table-bordered" style="width:100%">
              <thead>
                <tr>
                  <th>{% trans 'Name' %}</th>
                  <th>{% trans 'Phone number' %}</th>
                  <th>{% trans 'Location' %}</th>
                  <th>{% trans 'Organization' %}</th>
                  <th>{% trans 'Users' %}</th>
                </tr>
              </thead>
              <tbody>
                {% for lab in labs %}
                  <tr>
                  <td>{{lab.name}}</td>
                    <td>{{lab.phone_number}}</td>
                    <td>{{lab.location}}</td>
                    <td>{{lab.organization}}</td>
                    <td><a href="{% url 'laboratory:users_management' lab.pk %}"><i class="fa fa-plus" aria-hidden="true"></i></a></td>
                  </tr>
                {% endfor %}
              </tbody>
              <tfoot>
                <tr>
                  <th>{% trans 'Name' %}</th>
                  <th>{% trans 'Phone number' %}</th>
                  <th>{% trans 'Location' %}</th>
                  <th>{% trans 'Organization' %}</th>
                  <th>{% trans 'Users' %}</th>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>
        <div class="x_panel">
          <div class="x_title">
            <h2>{% trans 'Organizations list' %}</h2>
            <ul class="nav navbar-right panel_toolbox"></ul>
            <div class="clearfix"></div>
          </div>
          <div class="x_content">
            <table id="orgs" class="table table-striped table-bordered" style="width:100%">
              <thead>
                <tr>
                  <th>{% trans 'Name' %}</th>
                  <th>{% trans 'Users' %}</th>
                  <th>{% trans 'Groups' %}</th>
                  <th>{% trans 'Actions' %}</th>
                </tr>
              </thead>
              <tbody>
                {% for item in orgs %}
                  <tr>
                  <td>{{item.organization.name}}</td>
                    <td>
                      <ul style="list-style-type:none;">
                        {% for user in item.users.all %}
                          <li>{{user}}</li>
                        {% endfor %}
                      </ul>
                    </td>
                    <td>{{item.group}}</td>
                    <td><a href="{% url 'laboratory:users_management' item.pk %}"><i class="fa fa-plus" aria-hidden="true"></i></a></td>
                  </tr>
                {% endfor %}
              </tbody>
              <tfoot>
                <tr>
                  <th>{% trans 'Name' %}</th>
                  <th>{% trans 'Users' %}</th>
                  <th>{% trans 'Groups' %}</th>
                  <th>{% trans 'Actions' %}</th>
                </tr>
              </tfoot>
            </table>
          </div>
        </div>
      </div>
    </div>
  </div>
{% endblock %}
{% block js %}
  <script>
    $(document).ready(function() {
      $('#labs').DataTable();
      $('#orgs').DataTable();
    });
  </script>
{% endblock %}