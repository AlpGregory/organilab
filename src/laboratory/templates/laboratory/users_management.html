{% extends 'base.html' %}
{% load bootstrap i18n static laboratory%}
{% load static %}
{% load gtsettings %}
{% block pre_head %}
    {% define_true "use_datatables" as use_datatables %}
{% endblock %}

{% block title %}{% trans 'Users Management' %}{% endblock %}
{% block content %}
<div class="row">
<div class="col-md-offset-2 col-md-8">
        <div class="page-header col-xs-13" align="center">
          <h3 class="heading-1" ><span>{{ organization.name }}</span></h3>
        </div>
</div>
</div>
<div class="table-responsive">
<table id="userstable" class="table table-striped table-bordered" style="width:100%">
     <thead>
     <tr>
         <th>{% trans 'Username' %}</th>
         <th>{% trans 'Full name' %}</th>
         <th>{% trans 'Email' %}</th>
         <th>{% trans 'Delete' %}</th>
     </tr>
     </thead>
     <tbody>

     {% if users_list %}

         {% for user in users_list %}
            <tr>
            <td>{{ user.username }}</td>
            <td>{{ user.get_full_name }}</td>
            <td>{{ user.email }}</td>
            <td align="center">

                <a class="btn btn-danger pull-center delete_user" data-toggle="modal" data-target="#modalConfirmDelete"
                   data-id="{{ user.pk }}" data-name="{{ user.get_full_name }}">
                    <i class="fa fa-trash"></i></a>
            </td>
            </tr>
         {% endfor %}

     {% endif %}

     </tbody>
 </table>
</div>
<div class="modal fade" id="modalConfirmDelete" tabindex="-1" role="dialog" aria-hidden="true">
  <div class="modal-dialog modal-sm modal-notify modal-danger" role="document">
    <div class="modal-content text-center">
      <div class="modal-header d-flex justify-content-center">
        <p class="heading">{% trans 'Are you sure?' %}</p>
      </div>
      <div class="modal-body modal_user">
      </div>
      <div class="modal-footer flex-center">
        <a class="btn  btn-outline-danger" id="modal_delete_user">{% trans 'Yes' %}</a>
        <a type="button" class="btn  btn-danger waves-effect" data-dismiss="modal">{% trans 'No' %}</a>
      </div>
    </div>
  </div>
</div>
{% endblock %}
{% block javascripts %}
{{ block.super }}
<script>
(function(){
    $("#userstable").DataTable();

    $(".delete_user").on('click', function(){
        var url = "{% url 'laboratory:delete_user' organization.pk %}".concat(String($(this).data('id')));
        $("#modal_delete_user").attr('href', url);
        $("div.modal_user").text($(this).data('name'));
    });

})(jQuery);
</script>
{% endblock %}
